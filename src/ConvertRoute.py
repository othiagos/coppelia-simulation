import numpy as np
import csv


def save_route(drone_posicoes, filename):
    with open(filename, mode='w', newline='') as file:
        writer = csv.writer(file)
        writer.writerow(['X', 'Y', 'Z', 'ALFA', 'BETA', 'GAMA'])
        writer.writerows(drone_posicoes)


coord = np.array([3.275, 4.475, 0])

points = [[-0.6616086326539516, 0.738529424648732, 1.050000011920929], [-0.6616086326539516, 0.738529424648732, 0.75], [-1.216130942106247, 0.6922065317630768, 0.75], [-1.216130942106247, 0.6922065317630768, 0.45000001788139343], [-0.6616086326539516, 0.738529424648732, 0.15000000596046448], [0.24666139110922813, 1.331948161125183, 0.15000000596046448], [0.34551282227039337, 1.5, 0.15000000596046448], [0.5987179577350616, 1.5, 0.75], [0.34551282227039337, 1.5, 0.75], [0.24666139110922813, 1.331948161125183, 0.75], [0.24666139110922813, 1.331948161125183, 1.050000011920929], [0.5987179577350616, 1.5, 1.050000011920929], [1.4987179636955261, 0.6006544530391693, 1.050000011920929], [1.4987179636955261, 0.6006544530391693, 0.45000001788139343], [1.4987179636955261, 0.30130890011787415, 0.75], [1.4987179636955261, 0.0013088956475257874, 0.75], [1.4987179636955261, -0.298691101372242, 0.15000000596046448], [1.4987179636955261, -0.5986910909414291, 0.45000001788139343], [0.5993589758872986, -1.4986910820007324, 1.050000011920929], [0.0, -1.4986910820007324, 1.050000011920929], [-0.29999999701976776, -1.4986910820007324, 1.050000011920929], [-0.5999999940395355, -1.4986910820007324, 0.75], [-0.29999999701976776, -1.4986910820007324, 0.45000001788139343], [0.29999999701976776, -1.4986910820007324, 0.45000001788139343], [0.0, -1.4986910820007324, 0.15000000596046448], [-0.5999999940395355, -1.4986910820007324, 0.15000000596046448], [-1.5, -0.45785340666770935, 0.15000000596046448], [-1.5, -0.1578534017316997, 1.050000011920929]]
directions_vec = [[-0.05262081325054169, -0.9986145496368408, -0.0], [-0.05262081325054169, -0.9986145496368408, -0.0], [0.9612303972244263, -0.27574658393859863, -0.0], [0.9612303972244263, -0.27574658393859863, -0.0], [-0.05262081325054169, -0.9986145496368408, -0.0], [-0.39212971925735474, -0.9199099540710449, -0.0], [-0.0, -1.0, -0.0], [-0.0, -1.0, -0.0], [-0.0, -1.0, -0.0], [-0.39212971925735474, -0.9199099540710449, -0.0], [-0.39212971925735474, -0.9199099540710449, -0.0], [-0.0, -1.0, -0.0], [-1.0, -0.0, -0.0], [-1.0, -0.0, -0.0], [-1.0, -0.0, -0.0], [-1.0, -0.0, -0.0], [-1.0, -0.0, -0.0], [-1.0, -0.0, -0.0], [-0.0, 1.0, -0.0], [-0.0, 1.0, -0.0], [-0.0, 1.0, -0.0], [-0.0, 1.0, -0.0], [-0.0, 1.0, -0.0], [-0.0, 1.0, -0.0], [-0.0, 1.0, -0.0], [-0.0, 1.0, -0.0], [1.0, -0.0, -0.0], [1.0, -0.0, -0.0]]

if __name__ == '__main__':
    output_filename = 'rota_office_test.csv'

    list_position = []

    base_vec = np.array([1, 0])

    directions = []
    directions_vectors = [np.array(d[:2]) for d in directions_vec]

    for vec in directions_vectors:
        cosTheta = np.dot(vec, base_vec) / np.linalg.norm(vec) / np.linalg.norm(base_vec)
        theta = -np.arccos(cosTheta) if vec[1] < base_vec[1] else np.arccos(cosTheta)
        directions.append([0, 0, theta])

    list_position = [np.concatenate((point + coord, vector)) for point, vector in zip(points, directions)]
    save_route(list_position, output_filename)
